# Viby 使用示例

本文档提供了 Viby 工具的各种使用场景和示例，帮助用户充分利用该工具的功能。

## 1. 配置示例

### 1.1 初始配置

首次安装 Viby 后，您可以运行配置向导进行初始设置：

```bash
yb --config
```

配置向导界面示例：

```bash
正在检查终端是否支持中文...
测试中文支持

=============================================================================================
                                                       Viby 配置向导 / Viby Configuration Wizard                                                        
=============================================================================================

请选择界面语言 / Please select interface language:
  1. English
  2. 中文
[1]: 2

已选择中文界面

───────────────────────────────────────────────────────────────────────────────────────
默认 API 基础URL [http://localhost:1234]:
默认 API 密钥(如需) (输入 'pass' 跳过) []:
───────────────────────────────────────────────────────────────────────────────────────

=======================================================================================
                                                                       --- 默认模型配置 ---                                                                  
=======================================================================================

默认模型名称 [qwen3-30b-a3b-mlx@4bit]:
qwen3-30b-a3b-mlx@4bit 的 API URL (可选, 留空则使用默认) (输入 'pass' 跳过) [http://localhost:1234]:
qwen3-30b-a3b-mlx@4bit 的 API 密钥 (可选, 留空则使用默认) (输入 'pass' 跳过) []:
───────────────────────────────────────────────────────────────────────────────────────

=======================================================================================
                                                                   --- Think 模型配置 (可选) ---                                                             
=======================================================================================

Think 模型名称 (可选, 留空跳过) (输入 'pass' 跳过) [qwen3-32b-mlx]:
qwen3-32b-mlx 的 API URL (可选, 留空则使用默认) (输入 'pass' 跳过) [http://localhost:1234]:
qwen3-32b-mlx 的 API 密钥 (可选, 留空则使用默认) (输入 'pass' 跳过) []:
───────────────────────────────────────────────────────────────────────────────────────

=======================================================================================
                                                                   --- Fast 模型配置 (可选) ---                                                              
=======================================================================================

Fast 模型名称 (可选, 留空跳过) (输入 'pass' 跳过) [qwen3-0.6b-mlx]:
qwen3-0.6b-mlx 的 API URL (可选, 留空则使用默认) (输入 'pass' 跳过) []:
qwen3-0.6b-mlx 的 API 密钥 (可选, 留空则使用默认) (输入 'pass' 跳过) []:
───────────────────────────────────────────────────────────────────────────────────────
温度参数 (0.0-1.0) [0.7]:
最大令牌数 [40960]:
API 超时时间(秒) [300]:
启用MCP工具
  1. 是
  2. 否
[1]: 1

MCP配置文件夹：/Users/JohanLi233/.config/viby

───────────────────────────────────────────────────────────────────────────────────────
配置已保存至: /Users/JohanLi233/.config/viby/config.yaml

按 Enter 键继续...
usage: yb [-h] [-v] [--chat] [--shell] [--config] [--think] [--fast] [prompt]

viby - 一个与大语言模型交互的多功能命令行工具

positional arguments:
  prompt         要发送给模型的提示内容

options:
  -h, --help     显示此帮助信息并退出
  -v, --version  显示程序版本号并退出
  --chat, -c     启动与模型的交互式对话会话
  --shell, -s    生成并选择性执行Shell命令
  --config       启动交互式配置向导
  --think, -t    使用思考模型进行更深入的分析（如果已配置）
  --fast, -f     使用快速模型进行更快的响应（如果已配置）

示例:
  yb  "什么是斐波那契数列?"
  git diff | yb  "帮我写一个commit消息"
  yb  --shell "找当前目录下所有json文件"

```

## 流式输出渲染配置 (Stream Output Rendering Configuration)

Viby 现在支持自定义流式输出渲染，提供更流畅的用户体验。您可以通过配置向导调整这些选项：

```bash
yb --config
```

在配置向导中，您可以设置以下渲染选项：

1. **打字机效果**：启用后，文本会以打字机效果逐字显示
2. **平滑滚动**：提供更平滑的滚动效果
3. **光标配置**：自定义光标显示和闪烁
4. **动画效果**：启用加载动画和过渡效果
5. **高级渲染设置**：调整节流时间和缓冲区大小，优化性能

这些设置保存在 `~/.config/viby/config.yaml` 中的 `render_config` 部分。高级用户可以直接编辑此文件，但建议使用配置向导以避免语法错误。

示例渲染配置：

```yaml
render_config:
  typing_effect: true
  typing_speed: 0.01
  smooth_scroll: true
  show_cursor: true
  cursor_char: ▌
  cursor_blink: true
  enable_animations: true
  throttle_ms: 50
  buffer_size: 10
  code_block_instant: true
```

调整以上参数可以获得最适合您终端环境的渲染效果。

## 2. 基本使用示例

### 2.1 单次问答

最基本的用法是直接询问 Viby 问题：

```bash
yb "什么是Python装饰器？请给出示例"
```

输出示例：

```python
Python装饰器是一种函数，它接受另一个函数作为参数，并返回一个新的函数，通常用于在不修改原函数代码的情况下增强其功能。

基本示例：

def log_function(func):
    def wrapper(*args, **kwargs):
        print(f"调用函数: {func.__name__}")
        result = func(*args, **kwargs)
        print(f"函数 {func.__name__} 执行完毕")
        return result
    return wrapper

@log_function
def greet(name):
    print(f"你好，{name}!")

greet("张三")

# 输出:
# 调用函数: greet
# 你好，张三!
# 函数 greet 执行完毕
```

### 2.2 交互式聊天

启动交互式聊天会话：

```bash
yb  --chat
```

聊天会话示例：

```markdown

用户> 我想做一个待办事项应用，需要哪些功能？
助手> 一个基本的待办事项应用通常需要以下核心功能：

1. 任务管理：
   - 添加新任务
   - 编辑现有任务
   - 删除任务
   - 标记任务完成/未完成

2. 任务组织：
   - 分类/标签系统
   - 优先级设置
   - 到期日期设置
   - 列表或项目分组

3. 提醒功能：
   - 日期提醒
   - 重复任务设置

4. 用户体验：
   - 简洁明了的界面
   - 搜索功能
   - 排序和筛选

5. 数据管理：
   - 数据同步/备份
   - 导入/导出功能

您想重点关注哪些功能？

用户> 如何实现任务持久化存储？
助手> 任务持久化存储可以通过多种方式实现，取决于您的应用类型和规模：

1. 本地文件存储：
   - JSON 文件：简单应用的常用选择
   - SQLite：轻量级但功能完整的关系数据库
   - XML 或 YAML 文件：适合配置和小型数据

2. 关系数据库：
   - MySQL/PostgreSQL：适合需要复杂查询的大型应用
   - 支持事务和数据完整性

3. NoSQL 数据库：
   - MongoDB：适合频繁变化的数据结构
   - Firebase/Firestore：适合跨平台应用和实时同步

4. 云存储服务：
   - AWS DynamoDB
   - Azure Cosmos DB
   - Google Cloud Datastore

5. 移动应用特定存储：
   - iOS：Core Data, UserDefaults
   - Android：Room, SharedPreferences
```

### 2.3 中断模型响应

在使用 Viby 时，如果模型正在生成较长的响应，您可以随时按下 `Enter` 键来中断当前响应：

- 在单次问答模式下，中断后会结束当前会话
- 在交互式聊天模式下，中断后会返回到输入提示，您可以继续输入新的问题

这个功能在以下情况特别有用：
- 模型生成的回答过于冗长
- 回答偏离了您的预期方向
- 您已经得到了所需的信息，不需要继续等待

|> exit

```

### 2.4 Shell 命令生成

生成并执行 Shell 命令：

```bash
yb "创建一个包含三个子目录的项目，并初始化为git仓库"
```

输出示例：

```bash
生成的命令:
mkdir -p project/{src,docs,tests} && cd project && git init

是否执行此命令? [r]运行, [e]编辑, [y]复制, [c]对话, [q]放弃 (默认: 运行): 
```

### 2.5 Shell命令魔法集成

您可以在 Viby 命令中使用 `$(...)` 语法执行任何 shell 命令，并将其输出作为上下文传递给 AI。这个强大的功能允许您结合 shell 的灵活性和 AI 的智能：

**列出目录内容：**

```bash
yb "$(ls) 当前目录下都有哪些文件？"
```

输出示例：

```
当前目录下的文件和文件夹包括：
文件：
 • CODE_OF_CONDUCT.md
 • config.example.yaml
 • LICENSE
 • pyproject.toml
 • README.md
 • README.zh-CN.md
 • uv.lock
文件夹：
 • dist/
 • docs/
 • viby/
 • viby.egg-info/
```

**获取当前路径：**

```bash
yb "$(pwd) 这个路径下的文件结构是什么样的？"
```

**分析Git状态：**

```bash
yb "$(git status) 我应该先提交哪些文件？"
```

**查看系统信息：**

```bash
yb "$(uname -a) 这是什么操作系统？"
```

**分析代码文件：**

```bash
yb "$(cat main.py) 这段代码有哪些可能的改进点？"
```

这种方式特别适合于：
- 快速获取并分析系统信息
- 结合多个命令的输出进行复杂分析
- 让 AI 基于实时系统状态提供建议

## 3. 高级功能示例

### 3.1 使用思考模型

当需要更复杂的思考能力时，使用思考模型：

```bash
yb  --think "帮我优化这段代码，重点考虑性能：
def fibonacci(n):
    if n <= 1:
        return n
    return fibonacci(n-1) + fibonacci(n-2)"
```

### 3.2 使用快速模型

对于简单任务，使用快速模型提高响应速度：

```bash
yb  --fast "将'Hello, World!'翻译成中文"
```

### 3.3 使用MCP工具

使用MCP工具扩展功能：

```bash
yb  "使用天气工具查询北京明天的天气"
```

## 4. 命令参考

Viby  提供了一系列命令来与大语言模型进行不同方式的交互。

### 4.1 `yb  [问题]`
- **功能**：直接向 AI 提问并获取一次性回答。这是 yb  的默认行为，如果第一个参数不是一个已知的选项，它将被视为一个问题。
- **示例**：
  ```bash
  yb  "中国的首都是哪里？"
  yb  "解释一下什么是云计算"
  ```

### 4.2 `yb  --chat`
- **功能**：启动一个交互式的聊天会话，允许进行多轮对话。
- **示例**：
  ```bash
  yb  --chat
  ```
  进入聊天模式后，您可以直接输入问题，使用 `exit` 退出。

### 4.3 `yb [命令任务描述]`
- **功能**：当询问有关shell命令或操作时，Viby自动检测您的意图并生成相应的命令，提供执行选项（运行、编辑、复制、放弃）。
- **示例**：
  ```bash
  yb "列出当前目录下所有的 .txt 文件并统计行数"
  ```

### 4.4 `yb  --config`
- **功能**：启动配置向导，用于设置 API 地址、模型、语言、温度等参数。
- **示例**：
  ```bash
  yb  --config
  ```

### 4.5 `yb  --version`
- **功能**：显示 Viby 工具的当前版本号。
- **示例**：
  ```bash
  yb  --version
  ```

### 4.6 `yb  --help`
- **功能**：显示帮助信息，列出所有可用命令和选项。
- **别名**: `-h`
- **示例**：
  ```bash
  yb  --help
  ```

## 5. 常见使用场景

1. **代码辅助**：解释代码、生成代码片段、调试帮助
2. **文本处理**：翻译、摘要、润色文本
3. **知识查询**：基本概念解释和知识问答
4. **Shell操作**：生成复杂或难以记忆的命令
5. **创意写作**：写作构思、内容创建辅助
6. **数据分析**：简单数据解释和处理建议
7. **学习辅助**：概念解释和学习材料生成

---